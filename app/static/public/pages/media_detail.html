<![CDATA[
<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, viewport-fit=cover, interactive-widget=overlays-content">
  <title>Grok2API - Media 单图详情</title>
  <link rel="icon" href="/static/common/img/favicon/favicon.ico">
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#fafafa">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="Grok2API">
  <link rel="apple-touch-icon" href="/static/public/pwa/apple-touch-icon.png">

  <script src="/static/vendor/tailwind/tailwindcss-cdn.js"></script>
  <link href="/static/vendor/geist/geist-sans.css" rel="stylesheet">
  <link href="/static/vendor/geist/geist-mono.css" rel="stylesheet">
  <script src="/static/common/js/theme.js?v=0.1.0"></script>

  <link href="/static/common/css/common.css?v=0.3.8" rel="stylesheet">
  <link href="/static/common/css/toast.css" rel="stylesheet">
  <link href="/static/public/css/media_detail.css?v=0.1.0" rel="stylesheet">
</head>

<body class="public-page min-h-screen flex flex-col" style="background-color: var(--bg);">
  <div id="toast-container" class="toast-container"></div>
  <div id="app-header"></div>

  <main class="flex-1 mx-auto w-full max-w-none px-4 sm:px-6 py-5 sm:py-8 fade-in">
    <div class="media-detail-layout">
      <aside class="media-detail-video-column" aria-label="Media detail video list">
        <section class="media-detail-video-surface" aria-label="Media detail video results">
          <div class="media-detail-video-head">
            <div class="media-detail-video-title">视频结果</div>
            <div class="media-detail-video-subtitle">基于当前图片生成视频（SSE 流式返回）</div>
          </div>

          <div id="detailVideoEmpty" class="media-detail-video-empty">
            <div class="empty-title">还没有视频</div>
            <div class="empty-subtitle">在下方输入提示词（可选）并点击“生成视频”</div>
          </div>

          <div id="detailVideoResults" class="media-detail-video-results" tabindex="0"></div>
        </section>

        <!-- Desktop: thin invisible wheel sensor to scroll left filmstrip (Grok-like) -->
        <div id="detailLeftScrollSensor" class="media-detail-left-scroll-sensor" aria-hidden="true"></div>
      </aside>

      <section class="media-detail-stage" aria-label="Media detail image stage">
        <div id="mediaDetailEmpty" class="media-detail-empty">
          <div class="empty-title">未找到图片</div>
          <div class="empty-subtitle">请从 Media 瀑布流点击图片进入详情页</div>
        </div>

        <img id="detailImage" class="media-detail-image" alt="media-detail" />

        <div id="detailStageVideoWrap" class="media-detail-stage-video" hidden>
          <div id="detailStageVideoFrame" class="media-detail-stage-video-frame">
            <video id="detailStageVideo" controls preload="metadata" playsinline webkit-playsinline></video>
          </div>
        </div>
      </section>

      <aside class="media-detail-panel" aria-label="Media detail information">
        <div class="media-detail-title-row">
          <h2 class="media-detail-title">单图详情</h2>
          <div class="media-detail-subtitle">以 Prompt 为主；其余信息收纳到“高级信息”</div>
        </div>

        <div class="media-detail-action-group" role="region" aria-label="Media detail actions">
          <button id="backBtn" class="media-detail-action-btn" type="button" aria-label="Back to media">
            返回
          </button>

          <span class="media-detail-actions-sep"></span>

          <button id="downloadBtn" class="media-detail-action-btn" type="button" aria-label="Download image">
            下载
          </button>

          <button id="copyMainBtn" class="media-detail-action-btn" type="button" aria-label="Copy image url">
            复制地址
          </button>

          <button id="favoriteBtn" class="media-detail-action-btn" type="button" aria-pressed="false" aria-label="Favorite media item">
            收藏
          </button>

          <button id="editImageBtn" class="media-detail-action-btn" type="button" aria-label="Edit image in workbench">
            编辑
          </button>

          <span class="media-detail-actions-sep"></span>

          <button id="upscaleBtn" class="media-detail-action-btn" type="button" aria-pressed="false" aria-label="Upscale toggle">
            超分：关
          </button>
        </div>

        <div class="media-detail-meta">
          <!-- Default: keep Prompt visible -->
          <div class="media-detail-meta-item">
            <div class="media-detail-meta-label">Prompt</div>
            <div class="media-detail-meta-value" id="promptText">-</div>
            <button class="geist-button-outline media-detail-copy-btn" id="copyPromptBtn" type="button">复制</button>
          </div>

          <!-- Advanced: collapse noisy fields by default -->
          <details class="media-detail-advanced" id="advancedMeta" aria-label="Media detail advanced information">
            <summary class="media-detail-advanced-summary">高级信息</summary>

            <div class="media-detail-advanced-body">
              <div class="media-detail-meta-item">
                <div class="media-detail-meta-label">图片地址</div>
                <div class="media-detail-meta-value mono" id="imageUrlText">-</div>
                <button class="geist-button-outline media-detail-copy-btn" id="copyUrlBtn" type="button">复制地址</button>
              </div>

              <div class="media-detail-meta-item">
                <div class="media-detail-meta-label">图片 ID / parentPostId</div>
                <div class="media-detail-meta-value mono" id="imageIdText">-</div>
                <button class="geist-button-outline media-detail-copy-btn" id="copyIdBtn" type="button">复制 ID</button>
              </div>

              <div class="media-detail-meta-item">
                <div class="media-detail-meta-label">sourceImageUrl（尝试）</div>
                <div class="media-detail-meta-value mono" id="sourceUrlText">-</div>
                <button class="geist-button-outline media-detail-copy-btn" id="copySourceBtn" type="button">复制</button>
              </div>
            </div>
          </details>
        </div>
      </aside>
    </div>
  </main>

  <!-- Video composer -->
  <div class="media-detail-composer" role="region" aria-label="Media detail video composer">
    <div class="media-detail-composer-inner">
      <div class="media-detail-composer-row">
        <textarea id="detailVideoPromptInput" class="geist-input media-detail-video-prompt"
          placeholder="（可选）描述视频如何运动/镜头如何移动，例如：镜头缓慢推进，雨滴滑落，霓虹闪烁"></textarea>

        <div class="media-detail-composer-actions">
          <button id="detailVideoStartBtn" class="geist-button media-detail-primary-btn" type="button">生成视频</button>
          <button id="detailVideoStopBtn" class="geist-button-outline media-detail-secondary-btn hidden" type="button">停止</button>
          <button id="detailVideoAdvancedToggle" class="geist-button-outline media-detail-secondary-btn" type="button"
            aria-expanded="false" aria-controls="detailVideoAdvancedPanel">高级</button>
        </div>
      </div>

      <div class="media-detail-composer-meta">
        <span class="media-detail-video-status-label">视频</span>
        <span id="detailVideoStatusText" class="media-detail-video-status-value">未开始</span>
      </div>
    </div>
  </div>

  <!-- Advanced settings popover (moved out of composer flow; fixed layer) -->
  <div id="detailVideoAdvancedPopover" class="media-detail-advanced-popover-root">
    <div id="detailVideoAdvancedPanel" class="media-detail-video-advanced" hidden>
      <div class="media-detail-video-advanced-grid">
        <div class="media-detail-video-advanced-field">
          <label class="field-label" for="detailVideoRatioSelect">宽高比</label>
          <select id="detailVideoRatioSelect" class="geist-input">
            <option value="2:3">2:3 竖图</option>
            <option value="1:1">1:1 方图</option>
            <option value="3:2">3:2 横图</option>
            <option value="16:9" selected>16:9 宽屏</option>
            <option value="9:16">9:16 竖屏</option>
          </select>
        </div>

        <div class="media-detail-video-advanced-field">
          <label class="field-label" for="detailVideoParallelSelect">并发（1-8）</label>
          <input id="detailVideoParallelSelect" class="geist-input" type="number" inputmode="numeric" min="1" max="8"
            step="1" value="1" />
        </div>

        <div class="media-detail-video-advanced-field">
          <label class="field-label" for="detailVideoLengthSelect">时长</label>
          <select id="detailVideoLengthSelect" class="geist-input">
            <option value="6" selected>6s</option>
            <option value="10">10s</option>
            <option value="15">15s</option>
          </select>
        </div>

        <div class="media-detail-video-advanced-field">
          <label class="field-label" for="detailVideoResolutionSelect">分辨率</label>
          <select id="detailVideoResolutionSelect" class="geist-input">
            <option value="480p" selected>480p</option>
            <option value="720p">720p</option>
            <option value="1080p">1080p</option>
          </select>
        </div>

        <div class="media-detail-video-advanced-field">
          <label class="field-label" for="detailVideoPresetSelect">预设</label>
          <select id="detailVideoPresetSelect" class="geist-input">
            <option value="normal">normal</option>
            <option value="spicy">spicy</option>
            <option value="custom" selected>custom</option>
          </select>
        </div>
      </div>

      <div class="media-detail-video-advanced-hint">
        提示：Prompt 可为空；未选择目录写入时（如下载视频）仍走浏览器下载。
      </div>

      <div class="media-detail-video-advanced-actions">
        <button id="detailVideoClearBtn" class="geist-button-outline w-full" type="button">
          清空视频列表
        </button>
      </div>
    </div>
  </div>

  <!-- Clear confirm modal (T6/T7) -->
  <div id="detailVideoClearModal" class="md-modal-overlay" hidden aria-hidden="true">
    <div class="md-modal-backdrop" data-role="backdrop"></div>
    <div class="md-modal-content" role="dialog" aria-modal="true" aria-labelledby="detailVideoClearModalTitle"
      aria-describedby="detailVideoClearModalDesc" tabindex="-1">
      <div class="md-modal-title" id="detailVideoClearModalTitle">清空视频列表</div>
      <div class="md-modal-desc" id="detailVideoClearModalDesc">确定清空视频列表吗？该操作不会影响已生成的视频文件本身。</div>
      <div class="md-modal-actions">
        <button id="detailVideoClearModalCancel" class="geist-button-outline md-modal-btn" type="button">取消</button>
        <button id="detailVideoClearModalConfirm" class="geist-button-danger md-modal-btn" type="button">确认清空</button>
      </div>
    </div>
  </div>

  <div id="app-footer"></div>

  <script src="/static/common/js/admin-auth.js?v=0.3.0"></script>
  <script src="/static/common/js/public-header.js?v=0.3.3"></script>
  <script src="/static/common/js/footer.js?v=0.3.0"></script>
  <script src="/static/common/js/toast.js"></script>
  <script src="/static/common/js/pwa.js?v=0.1.1"></script>
  <script src="/static/public/js/media_detail.js?v=0.1.0"></script>
</body>

</html>
]]>